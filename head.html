<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="preconnect" href="https://acrobat.adobe.com" crossorigin>
<script src="/acrobat/scripts/scripts.js" type="module"></script>
<style>body { display: none; }</style>
<link rel="icon" href="data:,">
<script nomodule src="/acrobat/scripts/fallback.js"></script>
<script>
  window.setLibs = (prodLibs, location) => {
    const { hostname, search } = location || window.location;
    // eslint-disable-next-line compat/compat
    const branch = new URLSearchParams(search).get('milolibs') || 'main';
    if (branch === 'main' && hostname === 'www.stage.adobe.com') return 'https://www.stage.adobe.com/libs';
    if (!(hostname.includes('.hlx.') || hostname.includes('local') || hostname.includes('stage'))) return prodLibs;
    if (branch === 'local') return 'http://localhost:6456/libs';
    return branch.includes('--') ? `https://${branch}.hlx.live/libs` : `https://${branch}--milo--adobecom.hlx.live/libs`;
  };
  
  window.loadLink = (href, { as, callback, crossorigin, rel, fetchpriority } = {}) => {
  let link = document.head.querySelector(`link[href="${href}"]`);
  if (!link) {
    link = document.createElement('link');
    link.setAttribute('rel', rel);
    if (as) link.setAttribute('as', as);
    if (crossorigin) link.setAttribute('crossorigin', crossorigin);
    if (fetchpriority) link.setAttribute('fetchpriority', fetchpriority);
    link.setAttribute('href', href);
    if (callback) {
      link.onload = (e) => callback(e.type);
      link.onerror = (e) => callback(e.type);
    }
    document.head.appendChild(link);
  } else if (callback) {
    callback('noop');
  }
  return link;
}

window.loadStyle = (href, callback) => {
  return loadLink(href, { rel: 'stylesheet', callback });
}

const miloLibs = setLibs('/libs');

// Configurable preloads
const preloads = document.querySelector('meta[name="preloads"]')?.content;
if (preloads) {
  preloads.split(',').forEach((x) => {
    const link = x.trim().replace('$MILOLIBS', miloLibs);
    if (link.endsWith('.js')) {
      loadLink(link, { as: 'script', rel: 'preload', crossorigin: 'anonymous' });
    } else if (link.endsWith('.css')) {
      loadStyle(link);
    }
  });
}  
</script>